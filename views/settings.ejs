<% include partials/header %>

<%#  Functions %>
<%
 var diffBetweenDates = function(date, dueDate){
   var timeDiff = Math.abs(dueDate.getTime() - date.getTime());
   var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));
   return Math.floor(diffDays);

 }
%>


<div class="row">
  <div class="col m3">
      <div class="card-panel">
        <p class="flow-text center header">Amount Repaid vs Amount Owned</p>
      </div>
  </div>


  <div class="col m9">
    <div class="container">
      <div class="row">
       <div class="col s12 m12 card-title white-text center red accent-2 z-depth-3 topSpace">
            <h5 id="settingsLoanHeader" class="flow-text">Client name</h5>
            <h3><%=loan.firstName + " " + loan.lastName %></h3>
       </div>
     </div>

      <div class="card-tabs red accent-2">
        <ul class="tabs tabs-fixed-width">
          <li class="tab"><a href="#main" class="active">Basic Details</a></li>
          <li class="tab"><a href="#test6">Graphs</a></li>
          <li class="tab"><a href="#test6">Settings</a></li>
        </ul>
      </div>

      <div class="card-content">
        <div id="main"
         <div class="row card-panel  z-depth-4 red accent-2">
           <div class="col m12">
             <div class="row">
                <h3 class="center white-text"> Loan Details </h3>
                 <div class="col m6">
                    <div class="card-panel">
                      <h5>Days Until Due: <strong><%= diffBetweenDates(loan.date, loan.dateDue)%> days</strong></h5>
                      <div class="divider"></div>
                      <h5>Day Started: <strong><%= loan.date.toDateString() %></strong></h5>
                    </div>
                  </div>

                  <div class="col m6">
                      <div class="card-panel">
                       <!-- progress bar for days remaining -->
                       <h5 >Amount Paid: <strong>$<%= loan.amountRepaid %></strong></h5>
                        <div class="divider"></div>
                       <h5>Amount Remaining: <strong>$<%- loan.amountBorrowed - loan.amountRepaid %></strong></h5>
                     </div>
                   </div>
                </div>
                <div class="row section">
                  <h3 class="center white-text"> <strong>Contact Details</strong> </h3>
                    <div class="col m8 offset-m2  ">
                            <ul class="collection with-header" id="contactDetails">
                              <li class="collection-header"><h4 class="center">Contact  Details</h4></li>
                                <li class="collection-item"><h5>Email: </h5> <p class="flow-text"><%=loan.email%></li>
                                <li class="collection-item"><h5>Phone: </h5><p class="flow-text"><%=loan.contactNumber%></li>
                                <li class="collection-item"><h5>Address: </h5><p class="flow-text"><%=loan.address%></li>
                                  <li class="collection-item"><h5>Gender: </h5><p class="flow-text"><%=loan.gender%></li>
                            </ul>
                    </div>
                </div>
         </div>
        </div>
      </div>



         <div class="divider"></div>
           <!-- Pie chart for amount paid vs remaining -->
    </div>
  </div>
</div>

<!-- Modal Structure -->
<div id="modal1" class="modal">
  <div class="modal-content">
    <h4>Modal Header</h4>
    <p>A bunch of text</p>
  </div>
  <div class="modal-footer">
    <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
  </div>
</div>



</div>

<script>

</script>

<% include partials/footer %>
